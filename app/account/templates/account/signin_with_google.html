{% extends "base.html" %}

{% block body %}
<script src="https://accounts.google.com/gsi/client" async defer></script>
<div 
    id="g_id_onload"
    data-client_id="{{google_client_id}}"
    data-callback="handleCredentialResponse">
</div> 

<div class="flex items-center justify-center h-screen bg-black">
    <div class="w-1/3 bg-white p-8 rounded-xl flex flex-col gap-4">
        <h1 class="text-2xl">Sign in your account.</h1>
        <p>This is a demo sign in page. Add your details or cusomize it.</p>

        <div class="g_id_signin"
            data-type="standard"
            data-shape="pill"
            data-theme="filled_blue"
            data-text="signin_with"
            data-size="large"
        ></div>

        <p class="text-xs text-black/50">By signing in, you accept our terms and conditions and privacy policy.</p>
    </div>
</div>

<script>
    function handleCredentialResponse(response) {
        const idToken = response.credential;
        const url = `{{verify_url}}?id_token=${idToken}`;
        const data = {'id_token': idToken};

        fetch(url, {method: 'GET'})
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            console.log('Success:', data.url);
            window.location.replace(data.url);
            return;
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
  </script>

{% endblock body %}